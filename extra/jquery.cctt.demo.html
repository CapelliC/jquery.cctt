<!DOCTYPE html>
<!--
 * author: Capelli Carlo
 * license: MIT
-->
<html>
<head>
    <meta charset="utf-8">
    <title>jQuery CCTT Demo</title>

    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>

    <link rel="stylesheet" href="../jquery.cctt.css">
    <script src="../jquery.cctt.js"></script>
    
    <script src="html_uty.js"></script>
</head>

<p>
    First, an html table with manually expressed structure.
    Rows visibility should be coherent.
    If collapsed, following branch rows should be hidden.
</p>

<table class='cctt'>
    <tr>
        <th>A</th>
        <th>B</th>
        <th>C</th>
    </tr>

    <tr class='cctt-collapsed'>
        <td class='cctt-control'>A.1</td>
        <td>B.1.1</td>
        <td>C.1.1</td>
    </tr>
     <tr style='display:none;'>
        <td></td>
        <td>B.1.2</td>
        <td>C.1.2</td>
     </tr>
     <tr style='display:none;'>
        <td></td>
        <td>B.1.3</td>
        <td>C.1.3</td>
     </tr>

    <tr class='cctt-expanded'>
        <td class='cctt-control'>A.2</td>
        <td>B.2.1</td>
        <td>C.2.1</td>
    </tr>
    <tr class='cctt-expanded'>
        <td class='cctt-control'>A3</td>
        <td>B</td>
        <td>C</td>
    </tr>
</table>

<p>Next, a script constructed one.</p>
<div id='fill-with-table-1'></div>

<p>Another one, slightly different style.</p>
<div id='fill-with-table-2'></div>

<p>And now, let's CCTT handle structure initialization, guessing from data.</p>
<div id='fill-with-table-3'></div>

<script>

    const trace = console.log

    // get some DOM jQuery utilities
    /*
    trace(window.location)
    const l = ''+window.location
    var v = l.split('/')
    v[v.length-1] = 'html_uty.js'
    const s = v.join('/')
    trace('s', s)
    $.getScript(s)
    */
    //$.getScript('html_uty.js', (r,s) => trace('getScript', r, s))
    
    $(function() {
        
        if (false)
            $('.cctt').cctt()

        // examples of script constructed
        if (false) {
            const C = c => td({class:'cctt-control'}, c)
            const c = c => td(                        c)
            const x = td()
            
            const X = cs => tr({class:'cctt-expanded'}, cs)
            const Y = cs => tr({class:'cctt-collapsed'}, cs)            
            const h = cs => tr({style:{display:'none'}}, cs)

            $('#fill-with-table-1').append(table({id:'t-cctt', class:'cctt'}, [
                Y([C('A'),c('B'),c('C')]),
                 h([x,C('B'),c('C')]),
                 h(['','B','C'].map(td)),
                 h(['','B','C'].map(td)),
                Y([C('A'),c('B'),c('C')]),
                 h(['','B','C'].map(td)),
                 h(['','B','C'].map(td)),
                 h(['','B','C'].map(td)),
            ]))
            $('#t-cctt').cctt()
        }

        if (false) {
            $('#fill-with-table-2').html(table({class:'cctt'}, [
                tr({class:'cctt-collapsed'}, [td({class:'cctt-control'},  1),td( 2),td( 3)]),
                tr({style:{display:'none'}}, [td(                          ),td(12),td(13)]),
                tr({style:{display:'none'}}, [td(                          ),td(14),td(15)]),
                tr({class:'cctt-collapsed'}, [td({class:'cctt-control'},  2),td( 2),td( 3)]),
                tr({style:{display:'none'}}, [td(                          ),td(22),td(23)]),
                tr({style:{display:'none'}}, [td(                          ),td(24),td(25)]),
            ]).cctt())
        }

        if (true) {

            const t = table([
                ['a','b','c'].map(th),
                [ 1,  2,  3 ].map(td),
                [ 1,  2, 13 ].map(td),
                [ 1,  3, 14 ].map(td),
                [ 1,  3, 15 ].map(td),
            ].map(tr))
            $('#fill-with-table-3').append(t)
            $(t).cctt('structure_layout', t)
        }
    })
    
</script>
